# 律师任务管理系统 - 技术规范文档

## 1. 项目概述

- **项目名称**: 律师任务管理系统 (Lawyer Task Management System)
- **项目类型**: 全栈 Web 应用
- **核心功能**: 支持律师和律师助理协同的任务看板系统，包含用户管理、列管理和卡片管理功能
- **目标用户**: 律师事务所的律师、律师助理及管理员

## 2. 技术栈

### 后端
- **运行时**: Node.js 18+
- **框架**: Express.js
- **数据库**: MongoDB (本地部署)
- **ODM**: Mongoose

### 前端
- **框架**: React 18 + Vite
- **样式**: Tailwind CSS 3.x
- **拖拽**: SortableJS (vía react-sortablejs)
- **HTTP**: Axios

## 3. 数据模型

### 3.1 用户集合 (users)
```javascript
{
  _id: ObjectId,
  username: String,        // 用户名（显示在卡片上）
  password: String,       // 密码（MD5 加密存储）
  role: String,           // 'admin' | 'user'
  color: String,          // 专属颜色（HEX格式，如 '#FF5733'）
  createdAt: Date,
  updatedAt: Date
}
```

### 3.2 列集合 (columns)
```javascript
{
  _id: ObjectId,
  name: String,           // 列名
  order: Number,          // 排序序号
  createdAt: Date,
  updatedAt: Date
}
```

### 3.3 卡片集合 (cards)
```javascript
{
  _id: ObjectId,
  columnId: ObjectId,     // 所属列ID
  creatorId: ObjectId,    // 创建者ID
  creatorName: String,    // 创建者用户名（冗余存储）
  creatorColor: String,   // 创建者专属颜色（冗余存储）
  status: String,         // 'gray' | 'red' | 'green' 状态颜色
  order: Number,          // 在列内的排序序号
  createdAt: Date,
  updatedAt: Date
}
```

## 4. UI/UX 规范

### 4.1 配色方案
- **主色**: #1E3A5F (深蓝色 - 专业法律感)
- **次色**: #2D5A87 (中蓝色)
- **强调色**: #4A90D9 (亮蓝色)
- **背景色**: #F5F7FA (浅灰白)
- **卡片背景**: #FFFFFF
- **文字主色**: #1A1A2E
- **文字次色**: #6B7280
- **危险色**: #EF4444 (红色状态)
- **成功色**: #10B981 (绿色状态)
- **默认状态色**: #9CA3AF (灰色)

### 4.2 用户专属颜色池
系统为用户分配以下专属颜色（按顺序循环）:
- #FF6B6B (珊瑚红)
- #4ECDC4 (青绿)
- #45B7D1 (天蓝)
- #96CEB4 (薄荷绿)
- #FFEAA7 (淡黄)
- #DDA0DD (梅红)
- #98D8C8 (浅绿)
- #F7DC6F (金黄)
- #BB8FCE (淡紫)
- #85C1E9 (浅蓝)

### 4.3 字体
- **主字体**: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif
- **标题**: font-weight: 600-700
- **正文**: font-weight: 400

### 4.4 间距系统
- **基础单位**: 4px
- **小间距**: 8px (sm)
- **中间距**: 16px (md)
- **大间距**: 24px (lg)
- **超大间距**: 32px (xl)

### 4.5 响应式断点
- **移动端**: < 640px (sm)
- **平板**: 640px - 1024px (md)
- **桌面**: > 1024px (lg)

## 5. 页面规范

### 5.1 登录页面
- **路由**: `/login`
- **布局**: 居中卡片式布局
- **组件**:
  - Logo + 标题区域
  - 用户名输入框
  - 密码输入框
  - 登录按钮
- **移动端**: 全宽度输入框，卡片内边距减小

### 5.2 普通用户看板页面
- **路由**: `/board`
- **布局**:
  - 顶部导航栏 (固定高度 64px)
  - 主体横向滚动区域（看板列）
- **列样式**:
  - 宽度: 280px (桌面) / 260px (移动)
  - 背景: #F8FAFC
  - 圆角: 12px
  - 内边距: 12px
- **卡片样式**:
  - 背景: 白色
  - 圆角: 8px
  - 阴影: 0 2px 4px rgba(0,0,0,0.1)
  - 左侧 30% 宽度: 创建者专属颜色
  - 右侧 70% 宽度: 状态颜色
  - 顶部人名栏高度: 32px
  - 已完成状态: 左侧显示绿色勾选图标
- **移动端适配**:
  - 列支持横向滚动
  - 卡片宽度自适应列宽
  - 触摸拖拽支持

### 5.3 管理端页面
- **路由**: `/admin`
- **布局**:
  - 顶部导航栏
  - 左侧边栏 (固定宽度 240px)
  - 右侧内容区域
- **功能区域**:
  - 列管理面板
  - 用户管理面板

## 6. 功能规范

### 6.1 登录认证
- 用户名密码验证
- 错误提示: 用户名或密码错误
- 登录成功后存储 token (localStorage)
- 登出功能

### 6.2 列管理
- **查看**: 默认展示 5 列
- **新增**: 管理员添加自定义列名
- **删除**: 管理员删除列（级联删除该列所有卡片）
- **排序**: 按 order 字段排序展示

### 6.3 卡片管理
- **新增**: 点击列下方 "+" 按钮添加卡片
- **编辑状态**: 点击卡片切换状态颜色 (灰 → 红 → 绿)
- **删除**: 点击卡片弹出确认框，用户只能删除自己创建的卡片
- **拖拽**:
  - 同列内上下拖拽排序
  - 跨列左右拖拽移动

### 6.4 用户管理 (管理员)
- **新增用户**: 输入用户名和初始密码
- **查看用户列表**: 显示所有用户及专属颜色
- **删除用户**: 移除用户账户

## 7. API 接口规范

### 7.1 认证接口
| 方法 | 路径 | 说明 |
|------|------|------|
| POST | /api/auth/login | 用户登录 |
| POST | /api/auth/logout | 用户登出 |
| GET | /api/auth/me | 获取当前用户信息 |

### 7.2 列接口
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/columns | 获取所有列 |
| POST | /api/columns | 创建新列 |
| DELETE | /api/columns/:id | 删除列 |

### 7.3 卡片接口
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/cards | 获取所有卡片 |
| POST | /api/cards | 创建新卡片 |
| PUT | /api/cards/:id | 更新卡片（状态、位置） |
| DELETE | /api/cards/:id | 删除卡片 |

### 7.4 用户接口
| 方法 | 路径 | 说明 |
|------|------|------|
| GET | /api/users | 获取所有用户 |
| POST | /api/users | 创建新用户 |
| DELETE | /api/users/:id | 删除用户 |

## 8. 安全规范

- 密码使用 MD5 加密存储
- API 接口需要验证用户登录状态
- 管理员接口需要验证 admin 角色权限
- 跨域请求配置 (CORS)

## 9. 验收标准

### 功能验收
- [ ] 用户可以登录系统
- [ ] 普通用户可以看到任务看板
- [ ] 用户可以创建任务卡片
- [ ] 用户可以拖拽卡片调整位置
- [ ] 用户可以修改卡片状态颜色
- [ ] 用户只能删除自己创建的卡片
- [ ] 管理员可以管理列（增删）
- [ ] 管理员可以管理用户（增删）
- [ ] 所有数据持久化存储到 MongoDB
- [ ] 移动端可以正常访问和操作

### 视觉验收
- [ ] 看板风格符合 Trello 设计
- [ ] 卡片配色符合需求（左专属色+右状态色）
- [ ] 已完成卡片显示绿色勾选图标
- [ ] 响应式布局在不同设备正常工作
- [ ] 科技感 UI 设计

### 数据验收
- [ ] 页面刷新后数据不丢失
- [ ] 用户专属颜色正确分配
- [ ] 列顺序正确保存
- [ ] 卡片位置正确保存
